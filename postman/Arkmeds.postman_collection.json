{
  "info": {
    "_postman_id": "0cbe82e5-69b4-454a-a6ab-426e839a1e1b",
    "name": "Arkmeds",
    "description": "Coleção da API do projeto Arkmeds",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "_exporter_id": "29944103"
  },
  "item": [
    {
      "name": "ARK-01-driver",
      "item": [
        {
          "name": "Criar motorista",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var j = pm.response.json();",
                  "if (pm.response.code === 201 && j.id) { pm.collectionVariables.set('driverId', j.id); }"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"nome\": \"João Silva\",\n  \"cpf\": \"111.444.777-35\",\n  \"dataNascimento\": \"1990-05-15\",\n  \"sexo\": \"M\",\n  \"endereco\": {\n    \"rua\": \"Rua das Flores\",\n    \"numero\": \"123\",\n    \"bairro\": \"Centro\",\n    \"cidade\": \"São Paulo\",\n    \"cep\": \"01000-000\"\n  }\n}"
            },
            "url": "{{baseUrl}}/driver",
            "description": "POST /driver - Criar motorista. Erros: 400 (CPF inválido, data inválida, body inválido), 409 (CPF duplicado)."
          }
        },
        {
          "name": "Listar motoristas",
          "request": {
            "method": "GET",
            "header": [],
            "url": "{{baseUrl}}/driver",
            "description": "GET /driver - Listar motoristas."
          }
        },
        {
          "name": "Buscar motorista por id",
          "request": {
            "method": "GET",
            "header": [],
            "url": "{{baseUrl}}/driver/{{driverId}}",
            "description": "GET /driver/:id - Buscar por id. 404 se não existir."
          }
        },
        {
          "name": "Atualizar motorista",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"nome\": \"João Silva Atualizado\",\n  \"sexo\": \"M\"\n}"
            },
            "url": "{{baseUrl}}/driver/{{driverId}}",
            "description": "PUT /driver/:id - Atualizar. Campos opcionais: nome, cpf, dataNascimento, sexo, endereco. 400 (CPF/data inválidos), 404, 409 (CPF duplicado)."
          }
        },
        {
          "name": "Remover motorista",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": "{{baseUrl}}/driver/{{driverId}}",
            "description": "DELETE /driver/:id - Remover. 404 se não existir."
          }
        }
      ]
    },
    {
      "name": "ARK-01-passenger",
      "item": [
        {
          "name": "Criar passenger",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var j = pm.response.json();",
                  "if (pm.response.code === 201 && j.id) { pm.collectionVariables.set('passengerId', j.id); }"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"nome\": \"Maria Santos\",\n  \"cpf\": \"111.444.777-35\",\n  \"dataNascimento\": \"1992-08-20\",\n  \"sexo\": \"F\",\n  \"endereco\": {\n    \"rua\": \"Rua das Flores\",\n    \"numero\": \"456\",\n    \"bairro\": \"Centro\",\n    \"cidade\": \"Rio de Janeiro\",\n    \"cep\": \"20000-000\"\n  }\n}"
            },
            "url": "{{baseUrl}}/passenger",
            "description": "POST /passenger - Criar passenger. Erros: 400 (CPF inválido, data inválida, body inválido), 409 (CPF duplicado)."
          }
        },
        {
          "name": "Listar passengers",
          "request": {
            "method": "GET",
            "header": [],
            "url": "{{baseUrl}}/passenger",
            "description": "GET /passenger - Listar passengers."
          }
        },
        {
          "name": "Buscar passenger por id",
          "request": {
            "method": "GET",
            "header": [],
            "url": "{{baseUrl}}/passenger/{{passengerId}}",
            "description": "GET /passenger/:id - Buscar por id. 404 se não existir."
          }
        },
        {
          "name": "Atualizar passenger",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"nome\": \"Maria Santos Atualizado\",\n  \"sexo\": \"F\"\n}"
            },
            "url": "{{baseUrl}}/passenger/{{passengerId}}",
            "description": "PUT /passenger/:id - Atualizar. Campos opcionais: nome, cpf, dataNascimento, sexo, endereco. 400 (CPF/data inválidos), 404, 409 (CPF duplicado)."
          }
        },
        {
          "name": "Remover passenger",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": "{{baseUrl}}/passenger/{{passengerId}}",
            "description": "DELETE /passenger/:id - Remover. 404 se não existir."
          }
        }
      ]
    },
    {
      "name": "Fare",
      "item": [
        {
          "name": "POST /fare - Calcular tarifa (dia útil 08:00)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"from\": { \"lat\": -23.5505, \"lng\": -46.6333 },\n  \"to\": { \"lat\": -22.9099, \"lng\": -47.0626 },\n  \"datetime\": \"2025-01-15T08:00:00-03:00\"\n}"
            },
            "url": "{{baseUrl}}/fare",
            "description": "POST /fare - Calcular tarifa. from/to: { lat, lng }; datetime: ISO 8601 com timezone (ex: -03:00, Z). Retorna: fare, distanceKm, strategy (day|night|weekend_day|weekend_night)."
          }
        },
        {
          "name": "POST /fare - Noite 23:00 (dia útil)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"from\": { \"lat\": -23.5505, \"lng\": -46.6333 },\n  \"to\": { \"lat\": -22.9099, \"lng\": -47.0626 },\n  \"datetime\": \"2025-01-15T23:00:00-03:00\"\n}"
            },
            "url": "{{baseUrl}}/fare",
            "description": "Exemplo noturno (22:00–06:00) em dia útil → strategy night."
          }
        },
        {
          "name": "POST /fare - Fim de semana 17:00",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"from\": { \"lat\": -23.5505, \"lng\": -46.6333 },\n  \"to\": { \"lat\": -22.9099, \"lng\": -47.0626 },\n  \"datetime\": \"2025-01-18T17:00:00-03:00\"\n}"
            },
            "url": "{{baseUrl}}/fare",
            "description": "Exemplo sábado 17:00 → strategy weekend_day. datetime com timezone -03:00."
          }
        }
      ]
    },
    {
      "name": "ARK-03-race",
      "item": [
        {
          "name": "POST /race - Aceitar corrida",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"userId\": \"{{passengerId}}\",\n  \"requestId\": \"req-001\",\n  \"from\": { \"lat\": -23.5505, \"lng\": -46.6333 },\n  \"to\": { \"lat\": -22.9099, \"lng\": -47.0626 },\n  \"price\": 250.5,\n  \"distanceKm\": 100.2,\n  \"datetime\": \"2025-01-15T08:00:00-03:00\"\n}"
            },
            "url": "{{baseUrl}}/race",
            "description": "POST /race - Aceitar corrida. userId = ID do passageiro; requestId = identificador da oferta; from, to, price, distanceKm, datetime. Retorna 202 Accepted. O recibo é gerado em background em {RECEIPT_BASE_PATH ou /tmp}/{userId}/{yyyy-mm-dd}.txt (JSON)."
          }
        }
      ]
    }
  ],
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "type": "text/javascript",
        "packages": {},
        "requests": {},
        "exec": [
          ""
        ]
      }
    },
    {
      "listen": "test",
      "script": {
        "type": "text/javascript",
        "packages": {},
        "requests": {},
        "exec": [
          ""
        ]
      }
    }
  ],
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:3000",
      "type": "default"
    },
    {
      "key": "driverId",
      "value": "",
      "type": "default"
    },
    {
      "key": "passengerId",
      "value": "",
      "type": "default"
    }
  ]
}